# ë§¤ì§ ë„˜ë²„ & ë§¤ì§ ë°”ì´íŠ¸ ì™„ì „ ê°€ì´ë“œ

í”„ë¡œê·¸ë˜ë°ê³¼ ì‹œìŠ¤í…œ ê°œë°œì—ì„œ ìì£¼ ë§Œë‚˜ëŠ” "ë§¤ì§ ë„˜ë²„"ì™€ "ë§¤ì§ ë°”ì´íŠ¸" ê°œë…ì„ ì™„ì „íˆ ì´í•´í•˜ê¸° ìœ„í•œ ì°¸ê³  ë¬¸ì„œì…ë‹ˆë‹¤.

## ğŸ­ "ë§¤ì§"ì´ë¼ëŠ” ìš©ì–´ì˜ ì–´ì›

### ì™œ "ë§¤ì§(Magic)"ì¸ê°€?
- **ë§ˆë²•ì²˜ëŸ¼ ì‹ ë¹„ë¡œìš´**: íŠ¹ë³„í•œ ì˜ë¯¸ë¥¼ ê°€ì§„ ìˆ«ì/ë°”ì´íŠ¸ë“¤ì´ "ë§ˆë²•ì²˜ëŸ¼" íŒŒì¼ì˜ ì •ì²´ë¥¼ ì•Œë ¤ì¤Œ
- **ì¦‰ì‹œ ì¸ì‹**: íŒŒì¼ì„ ì—´ì§€ ì•Šê³ ë„ ì²˜ìŒ ëª‡ ë°”ì´íŠ¸ë§Œ ë³´ê³  "ë§ˆë²•ì²˜ëŸ¼" íŒŒì¼ í˜•ì‹ì„ ì•Œ ìˆ˜ ìˆìŒ
- **í‘œì¤€í™”ëœ ë¹„ë°€**: ëª¨ë“  í”„ë¡œê·¸ë˜ë¨¸ê°€ ì•„ëŠ” "ë§ˆë²•ì˜ ì£¼ë¬¸" ê°™ì€ íŠ¹ë³„í•œ ê°’ë“¤

### ì—­ì‚¬ì  ë°°ê²½
- **1970ë…„ëŒ€ Unix**: íŒŒì¼ í™•ì¥ìê°€ ì—†ë˜ ì‹œì ˆ, íŒŒì¼ ë‚´ìš©ìœ¼ë¡œ í˜•ì‹ì„ íŒë‹¨í•  í•„ìš”
- **file ëª…ë ¹ì–´**: Unixì˜ `file` ëª…ë ¹ì–´ê°€ ë§¤ì§ ë„˜ë²„ë¥¼ ì‚¬ìš©í•´ íŒŒì¼ í˜•ì‹ ê°ì§€
- **í‘œì¤€í™”**: ê° íŒŒì¼ í˜•ì‹ë§ˆë‹¤ ê³ ìœ í•œ "ì‹œê·¸ë‹ˆì²˜" ì •ë¦½

## ğŸ”¢ ë§¤ì§ ë„˜ë²„(Magic Number)ë€?

### ê¸°ë³¸ ì •ì˜
**ë§¤ì§ ë„˜ë²„**: íŒŒì¼, í”„ë¡œí† ì½œ, ë°ì´í„° êµ¬ì¡°ì—ì„œ **í˜•ì‹ì´ë‚˜ ë²„ì „ì„ ì‹ë³„**í•˜ê¸° ìœ„í•´ ì‚¬ìš©ë˜ëŠ” **ê³ ì •ëœ ìˆ«ì ê°’**

### í•µì‹¬ íŠ¹ì§•
1. **ê³ ìœ ì„±**: ê° í˜•ì‹ë§ˆë‹¤ ì„œë¡œ ë‹¤ë¥¸ ê°’
2. **ìœ„ì¹˜ ê³ ì •**: ë³´í†µ íŒŒì¼/ë°ì´í„°ì˜ ì‹œì‘ ë¶€ë¶„
3. **í‘œì¤€í™”**: ì—…ê³„ í‘œì¤€ìœ¼ë¡œ ì •í•´ì§„ ê°’
4. **ì¦‰ì‹œ ì¸ì‹**: ë¹ ë¥¸ í˜•ì‹ íŒë³„ ê°€ëŠ¥

## ğŸ”¤ ë§¤ì§ ë°”ì´íŠ¸(Magic Bytes)ë€?

### ê¸°ë³¸ ì •ì˜
**ë§¤ì§ ë°”ì´íŠ¸**: ë§¤ì§ ë„˜ë²„ë¥¼ **ë°”ì´íŠ¸ ë‹¨ìœ„ë¡œ í‘œí˜„**í•œ ê²ƒ. ì‹¤ì œ íŒŒì¼ì—ì„œ **16ì§„ìˆ˜ ë°”ì´íŠ¸ ì‹œí€€ìŠ¤**ë¡œ ë‚˜íƒ€ë‚¨

### í‘œí˜„ ë°©ì‹
```
ë§¤ì§ ë„˜ë²„: 0x7F454C46
ë§¤ì§ ë°”ì´íŠ¸: \x7F\x45\x4C\x46 (ë˜ëŠ” 7F 45 4C 46)
ì‹¤ì œ ì˜ë¯¸: 0x7F + "ELF"
```

## ğŸ“ ì‹¤ì œ íŒŒì¼ í˜•ì‹ë³„ ë§¤ì§ ë°”ì´íŠ¸

### ì´ë¯¸ì§€ íŒŒì¼
```bash
# PNG íŒŒì¼
89 50 4E 47 0D 0A 1A 0A
\x89PNG\r\n\x1a\n

# JPEG íŒŒì¼  
FF D8 FF
\xFF\xD8\xFF

# GIF íŒŒì¼
47 49 46 38 37 61  # GIF87a
47 49 46 38 39 61  # GIF89a
```

### ì••ì¶• íŒŒì¼
```bash
# ZIP íŒŒì¼
50 4B 03 04  # PK..
\x50\x4B\x03\x04

# RAR íŒŒì¼
52 61 72 21 1A 07 00  # Rar!...
\x52\x61\x72\x21\x1A\x07\x00

# 7Z íŒŒì¼
37 7A BC AF 27 1C  # 7z..'.
\x37\x7A\xBC\xAF\x27\x1C
```

### ì‹¤í–‰ íŒŒì¼
```bash
# Windows EXE
4D 5A  # MZ
\x4D\x5A

# Linux ELF (64ë¹„íŠ¸)
7F 45 4C 46 02 01 01 00 00 00 00 00 00 00 00 00 02 00 B7 00
\x7F\x45\x4C\x46\x02\x01\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02\x00\xB7\x00

# macOS Mach-O
CF FA ED FE  # 64ë¹„íŠ¸
CE FA ED FE  # 32ë¹„íŠ¸
```

### ë¬¸ì„œ íŒŒì¼
```bash
# PDF íŒŒì¼
25 50 44 46  # %PDF
\x25\x50\x44\x46

# MS Office (Modern)
50 4B 03 04  # ZIP ê¸°ë°˜
\x50\x4B\x03\x04

# RTF íŒŒì¼
7B 5C 72 74 66  # {\rtf
\x7B\x5C\x72\x74\x66
```

## ğŸ” ë§¤ì§ ë°”ì´íŠ¸ ë¶„ì„ ì‹¤ìŠµ

### 1. ì‹¤ì œ íŒŒì¼ì˜ ë§¤ì§ ë°”ì´íŠ¸ í™•ì¸
```bash
# íŒŒì¼ì˜ ì²˜ìŒ 16ë°”ì´íŠ¸ë¥¼ 16ì§„ìˆ˜ë¡œ ë³´ê¸°
hexdump -C -n 16 filename

# ë˜ëŠ” xxd ì‚¬ìš©
xxd -l 16 filename

# ì˜ˆì‹œ ì¶œë ¥ (PNG íŒŒì¼)
00000000  89 50 4e 47 0d 0a 1a 0a  50 49 44 41 54 48 89 ec  |.PNG....PIDATH..|
```

### 2. ì§ì ‘ ë§¤ì§ ë°”ì´íŠ¸ ìƒì„±í•˜ê¸°
```bash
# "TEST" ë¬¸ìì—´ì„ ë§¤ì§ ë°”ì´íŠ¸ë¡œ ë§Œë“¤ê¸°
echo -n "TEST" | hexdump -C
# 00000000  54 45 53 54                                       |TEST|

# ë°”ì´ë„ˆë¦¬ë¡œ ë§¤ì§ ë°”ì´íŠ¸ ë§Œë“¤ê¸°
printf "\x7F\x45\x4C\x46" > magic_test
hexdump -C magic_test
# 00000000  7f 45 4c 46                                       |.ELF|
```

### 3. file ëª…ë ¹ì–´ë¡œ ë§¤ì§ ë°”ì´íŠ¸ í™œìš© í™•ì¸
```bash
# file ëª…ë ¹ì–´ëŠ” ë§¤ì§ ë°”ì´íŠ¸ë¥¼ ì‚¬ìš©í•´ íŒŒì¼ í˜•ì‹ ê°ì§€
file /bin/bash
# /bin/bash: ELF 64-bit LSB pie executable, x86-64

file image.png  
# image.png: PNG image data, 1920 x 1080, 8-bit/color RGBA

file document.pdf
# document.pdf: PDF document, version 1.4
```

## ğŸ¯ WriterOS ê°œë°œì—ì„œì˜ ë§¤ì§ ë°”ì´íŠ¸

### 1. ELF ë§¤ì§ ë°”ì´íŠ¸ ìƒì„¸ ë¶„ì„ (ARM64 ì˜ˆì‹œ)
```
7F 45 4C 46 02 01 01 00 00 00 00 00 00 00 00 00 02 00 B7 00

ë¶„ì„:
7F 45 4C 46     â†’ 0x7F + "ELF" (ELF íŒŒì¼ ì‹œê·¸ë‹ˆì²˜)
02              â†’ 64ë¹„íŠ¸ ELF
01              â†’ ë¦¬í‹€ ì—”ë””ì•ˆ
01              â†’ ELF ë²„ì „ 1
00 00 00 00...  â†’ íŒ¨ë”© ë°”ì´íŠ¸ë“¤
02 00           â†’ ì‹¤í–‰ íŒŒì¼ íƒ€ì… (ET_EXEC)
B7 00           â†’ ARM64 ì•„í‚¤í…ì²˜ (EM_AARCH64 = 183 = 0xB7)
```

### 2. í¬ë¡œìŠ¤ ì»´íŒŒì¼ ê²°ê³¼ ê²€ì¦
```bash
# ì»´íŒŒì¼ëœ íŒŒì¼ì˜ ì•„í‚¤í…ì²˜ í™•ì¸
file writeros-test-amd64
# writeros-test-amd64: ELF 64-bit LSB executable, x86-64

file writeros-test-arm64  
# writeros-test-arm64: ELF 64-bit LSB executable, ARM aarch64

# ë§¤ì§ ë°”ì´íŠ¸ë¡œ ì§ì ‘ í™•ì¸
hexdump -C -n 20 writeros-test-arm64
# 00000000  7f 45 4c 46 02 01 01 00  00 00 00 00 00 00 00 00  |.ELF............|
# 00000010  02 00 b7 00                                       |....|
#             â†‘ ARM64 ì•„í‚¤í…ì²˜ ì½”ë“œ (0x00b7)
```

### 3. ì»¤ìŠ¤í…€ ë§¤ì§ ë°”ì´íŠ¸ ì •ì˜
```bash
# WriterOS ì „ìš© ì„¤ì • íŒŒì¼ ë§¤ì§ ë°”ì´íŠ¸ ì˜ˆì‹œ
# "WROS" + ë²„ì „ ì •ë³´
57 52 4F 53 01 00  # WROS v1.0
\x57\x52\x4F\x53\x01\x00

# C ì½”ë“œì—ì„œ í™•ì¸í•˜ëŠ” ë°©ë²•
#define WRITEROS_MAGIC 0x534F5257  // "WROS" (ë¦¬í‹€ ì—”ë””ì•ˆ)

bool is_writeros_config(const char* filename) {
    FILE* f = fopen(filename, "rb");
    uint32_t magic;
    fread(&magic, sizeof(magic), 1, f);
    fclose(f);
    return magic == WRITEROS_MAGIC;
}
```

## ğŸ› ï¸ ë§¤ì§ ë°”ì´íŠ¸ ì‘ì—… ë„êµ¬ë“¤

### ëª…ë ¹ì¤„ ë„êµ¬
```bash
# 1. hexdump - 16ì§„ìˆ˜ ë¤í”„
hexdump -C -n 16 file.bin

# 2. xxd - 16ì§„ìˆ˜ í¸ì§‘ê¸°
xxd -l 16 file.bin

# 3. od - 8ì§„ìˆ˜/16ì§„ìˆ˜ ë¤í”„  
od -t x1 -N 16 file.bin

# 4. file - ë§¤ì§ ë°”ì´íŠ¸ ê¸°ë°˜ íŒŒì¼ í˜•ì‹ ê°ì§€
file --mime-type file.bin

# 5. binwalk - ë°”ì´ë„ˆë¦¬ ë¶„ì„ (ë§¤ì§ ë°”ì´íŠ¸ ê²€ìƒ‰)
binwalk file.bin
```

### Pythonì—ì„œ ë§¤ì§ ë°”ì´íŠ¸ ë‹¤ë£¨ê¸°
```python
# íŒŒì¼ì˜ ë§¤ì§ ë°”ì´íŠ¸ ì½ê¸°
def read_magic_bytes(filename, num_bytes=8):
    with open(filename, 'rb') as f:
        magic = f.read(num_bytes)
    return magic.hex(), magic

# ì‚¬ìš© ì˜ˆì‹œ
hex_str, raw_bytes = read_magic_bytes('test.png', 8)
print(f"Hex: {hex_str}")      # 89504e470d0a1a0a
print(f"Raw: {raw_bytes}")    # b'\x89PNG\r\n\x1a\n'

# ë§¤ì§ ë°”ì´íŠ¸ë¡œ íŒŒì¼ í˜•ì‹ í™•ì¸
def detect_file_type(filename):
    magic, _ = read_magic_bytes(filename, 4)
    
    signatures = {
        '89504e47': 'PNG',
        'ffd8ffe0': 'JPEG',
        '504b0304': 'ZIP', 
        '7f454c46': 'ELF',
        '25504446': 'PDF'
    }
    
    return signatures.get(magic, 'Unknown')
```

## â— ë§¤ì§ ë°”ì´íŠ¸ ì‚¬ìš© ì‹œ ì£¼ì˜ì‚¬í•­

### 1. ì¶©ëŒ ê°€ëŠ¥ì„±
```bash
# ê°™ì€ ë§¤ì§ ë°”ì´íŠ¸ë¥¼ ì‚¬ìš©í•˜ëŠ” í˜•ì‹ë“¤
50 4B 03 04  # ZIP, DOCX, XLSX, JAR ë“±ì´ ëª¨ë‘ ë™ì¼
```

### 2. ë²„ì „ë³„ ì°¨ì´
```bash
# JPEGì˜ ì—¬ëŸ¬ ë²„ì „ë“¤
FF D8 FF E0  # JFIF
FF D8 FF E1  # EXIF  
FF D8 FF E8  # SPIFF
```

### 3. ë¶€ë¶„ ì¼ì¹˜ ë¬¸ì œ
```bash
# ë” ê¸´ ë§¤ì§ ë°”ì´íŠ¸ë¡œ ì •í™•í•œ íŒë³„ í•„ìš”
GIF87a: 47 49 46 38 37 61
GIF89a: 47 49 46 38 39 61
# ì²˜ìŒ 4ë°”ì´íŠ¸(4749463837)ë§Œìœ¼ë¡œëŠ” êµ¬ë¶„ ë¶ˆê°€
```

## ğŸ“š ì¶”ê°€ í•™ìŠµ ìë£Œ

### ë§¤ì§ ë°”ì´íŠ¸ ë°ì´í„°ë² ì´ìŠ¤
- **Wikipedia**: List of file signatures
- **Gary Kessler's File Signatures**: í¬ê´„ì ì¸ ë§¤ì§ ë°”ì´íŠ¸ ëª©ë¡
- **Unix file(1) magic**: `/usr/share/magic` íŒŒì¼ë“¤

### ê´€ë ¨ RFC ë° í‘œì¤€
- **RFC 2046**: MIME Media Types
- **ISO/IEC 14496**: MP4 ì»¨í…Œì´ë„ˆ í‘œì¤€
- **PNG Specification**: PNG ë§¤ì§ ë°”ì´íŠ¸ ì •ì˜

---

## ğŸ‰ ê²°ë¡ 

**ë§¤ì§ ë„˜ë²„/ë§¤ì§ ë°”ì´íŠ¸ì˜ í•µì‹¬:**

- ğŸ­ **"ë§ˆë²•"ì˜ ì˜ë¯¸**: íŒŒì¼ì˜ ì •ì²´ë¥¼ ì¦‰ì‹œ ì•Œë ¤ì£¼ëŠ” "ë§ˆë²•ì˜ ì£¼ë¬¸"
- ğŸ” **ë¹ ë¥¸ ì‹ë³„**: íŒŒì¼ í™•ì¥ì ì—†ì´ë„ ë‚´ìš©ë§Œìœ¼ë¡œ í˜•ì‹ íŒë³„
- ğŸ›¡ï¸ **ë³´ì•ˆ ê²€ì¦**: íŒŒì¼ ìœ„ì¥ ê³µê²© ë°©ì§€ 
- âš¡ **ì„±ëŠ¥ ìµœì í™”**: ì „ì²´ íŒŒì¼ì„ ì½ì§€ ì•Šê³ ë„ ë¹ ë¥¸ íŒë³„

**WriterOS ê°œë°œì—ì„œëŠ”:**
- âœ… ARM64/AMD64 ë°”ì´ë„ˆë¦¬ êµ¬ë¶„
- âœ… ì„¤ì • íŒŒì¼ ìœ íš¨ì„± ê²€ì¦
- âœ… ì‹œìŠ¤í…œ íŒŒì¼ ë¬´ê²°ì„± í™•ì¸
- âœ… ì»¤ìŠ¤í…€ í˜•ì‹ ì •ì˜ ê°€ëŠ¥

**ì´ì œ ë§¤ì§ ë°”ì´íŠ¸ê°€ ì •ë§ "ë§ˆë²•"ì²˜ëŸ¼ ëŠê»´ì§€ë‚˜ìš”? ğŸª„**

---
*ì´ ë¬¸ì„œëŠ” WriterOS ê°œë°œ ê³¼ì •ì—ì„œ ë§¤ì§ ë„˜ë²„/ë°”ì´íŠ¸ ì´í•´ë¥¼ ìœ„í•´ ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.* 